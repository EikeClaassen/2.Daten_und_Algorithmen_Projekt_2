classdef WaveGUI < handle
    %UNTITLED7 Summary of this class goes here
    %   Detailed explanation goes here
    
    properties 
        Handles;
        Timer;
        Speaker1;
    end
    
    
    methods
        function obj = WaveGUI
            obj.Timer = timer('Period',0.5,...
                              'TimerFcn',@(h,d)obj.runAnimation,...
                              'ExecutionMode','FixedRate');
            obj.Speaker1 = SourceOfSound();
            obj.openGUI();
        end
        
        
        function openGUI(obj) 
            hfig = figure('Name','Wellen-Maschine',...
                          'NumberTitle','off',... 
                          'Position',[100 100 1024 576],... 
                          'ToolBar','none',...
                          'MenuBar','none',...
                          'Resize','off',...
                          'CloseRequestFcn',@(hObject,data)obj.closeGUI); 
           
            hStart = uicontrol('String','Start',...
                               'Style','Pushbutton',... 
                               'Position',[780 30 100 30],...
                               'Callback',@(hObject,data)obj.startAnimation); 
 
            hStop = uicontrol('String','Stop',...
                              'Style','Pushbutton',... 
                              'Position',[900 30 100 30],...
                              'Callback',@(hObject,data)obj.stopAnimation); 
 
            hAnimation = uipanel('Visible','on',...
                                 'BackgroundColor','w',... 
                                 'Units','pixels',...
                                 'Position',[370 100 630 450]); 
                             
            hAnimationAxes = axes('Parent',hAnimation,...
                                  'Units','pixels',...
                                  'Position',[-10 -10 1000 600],...
                                  'XTick',[],'YTick',[],...
                                  'ButtonDownFcn',@obj.setSourceOfSound);
                              
            hSourceOfSound1Tick = uicontrol('Style','checkbox',...
                                            'Position',[250 530 15 15],...
                                            'Value',0,...
                                            'Callback',@(handles,event)obj.setSourceOfSound1Tick);
 
            hSourceOfSound1 = uipanel('Visible','on',...
                                      'Units','pixels',... 
                                      'Position',[30 375 215 175],...
                                      'Title','Speaker 1',...
                                      'FontSize',12);
                                  
            hSourceOfSound2Tick = uicontrol('Style','checkbox',...
                                            'Position',[250 350 15 15],...
                                            'Value',0,...
                                            'Callback',@(handles,event)obj.setSourceOfSound2Tick);
                                  
            hSourceOfSound2 = uipanel('Visible','on',...
                                      'Units','pixels',... 
                                      'Position',[30 195 215 175],...
                                      'Title','Speaker 2',...
                                      'FontSize',12);
                                  
            hSourceOfSound3Tick = uicontrol('Style','checkbox',...
                                            'Position',[250 170 15 15],...
                                            'Value',0,...
                                            'Callback',@(handles,event)obj.setSourceOfSound3Tick);
                                  
            hSourceOfSound3 = uipanel('Visible','on',...
                                      'Units','pixels',... 
                                      'Position',[30 15 215 175],...
                                      'Title','Speaker 3',...
                                      'FontSize',12);
                         
            hSinus1FrequenzText = uicontrol('Parent',hSourceOfSound1,...
                                            'Style','Text',...
                                            'String','Frequenz',...
                                            'Position',[10 140 180 20]);
                         
            hSinus1Frequenz = uicontrol('Parent',hSourceOfSound1,...
                                        'Style','Slider',...
                                        'Position',[10 125 170 20],...
                                        'Enable','off');
                                    
            hSinus1AmplitudeText = uicontrol('Parent',hSourceOfSound1,...
                                             'Style','Text',...
                                             'String','Amplitude',...
                                             'Position',[10 100 180 20]);
                                    
            hSinus1Amplitude = uicontrol('Parent',hSourceOfSound1,...
                                        'Style','Slider',...
                                        'Position',[10 85 170 20],...
                                        'Enable','off');
                                    
            hSinus1PhaseText = uicontrol('Parent',hSourceOfSound1,...
                                         'Style','Text',...
                                         'String','Phase',...
                                         'Position',[10 60 180 20]);
                                    
            hSinus1Phase = uicontrol('Parent',hSourceOfSound1,...
                                     'Style','Slider',...
                                      'Position',[10 45 170 20],...
                                      'Enable','off');
                                  
            hSinus1DampingText = uicontrol('Parent',hSourceOfSound1,...
                                           'Style','Text',...
                                           'String','Dämpfung',...
                                           'Position',[10 20 180 20]);
                                  
            hSinus1Damping = uicontrol('Parent',hSourceOfSound1,...
                                       'Style','Slider',...
                                       'Position',[10 5 170 20],...
                                       'Enable','off');
                                   
            hSinus2FrequenzText = uicontrol('Parent',hSourceOfSound2,...
                                            'Style','Text',...
                                            'String','Frequenz',...
                                            'Position',[10 140 180 20]);
            
            hSinus2Frequenz = uicontrol('Parent',hSourceOfSound2,...
                                        'Style','Slider',...
                                        'Position',[10 125 170 20],...
                                        'Enable','off');
                                    
            hSinus2AmplitudeText = uicontrol('Parent',hSourceOfSound2,...
                                             'Style','Text',...
                                             'String','Amplitude',...
                                             'Position',[10 100 180 20]);
                                    
            hSinus2Amplitude = uicontrol('Parent',hSourceOfSound2,...
                                        'Style','Slider',...
                                        'Position',[10 85 170 20],...
                                        'Enable','off');
                                    
            hSinus2PhaseText = uicontrol('Parent',hSourceOfSound2,...
                                         'Style','Text',...
                                         'String','Phase',...
                                         'Position',[10 60 180 20]);
                                    
            hSinus2Phase = uicontrol('Parent',hSourceOfSound2,...
                                     'Style','Slider',...
                                     'Position',[10 45 170 20],...
                                     'Enable','off');
                                 
            hSinus2DampingText = uicontrol('Parent',hSourceOfSound2,...
                                           'Style','Text',...
                                           'String','Dämpfung',...
                                           'Position',[10 20 180 20]);
                                  
            hSinus2Damping = uicontrol('Parent',hSourceOfSound2,...
                                       'Style','Slider',...
                                       'Position',[10 5 170 20],...
                                       'Enable','off');
                                   
            hSinus3FrequenzText = uicontrol('Parent',hSourceOfSound3,...
                                            'Style','Text',...
                                            'String','Frequenz',...
                                            'Position',[10 140 180 20]);
                                    
            hSinus3Frequenz = uicontrol('Parent',hSourceOfSound3,...
                                        'Style','Slider',...
                                        'Position',[10 125 170 20],...
                                        'Enable','off');
                                    
            hSinus3AmplitudeText = uicontrol('Parent',hSourceOfSound3,...
                                             'Style','Text',...
                                             'String','Amplitude',...
                                             'Position',[10 100 180 20]);
                                    
            hSinus3Amplitude = uicontrol('Parent',hSourceOfSound3,...
                                        'Style','Slider',...
                                        'Position',[10 85 170 20],...
                                        'Enable','off');
                                    
            hSinus3PhaseText = uicontrol('Parent',hSourceOfSound3,...
                                         'Style','Text',...
                                         'String','Phase',...
                                         'Position',[10 60 180 20]);
                                    
            hSinus3Phase = uicontrol('Parent',hSourceOfSound3,...
                                        'Style','Slider',...
                                        'Position',[10 45 170 20],...
                                        'Enable','off');
                                    
            hSinus3DampingText = uicontrol('Parent',hSourceOfSound3,...
                                           'Style','Text',...
                                           'String','Dämpfung',...
                                           'Position',[10 20 180 20]);
                                    
            hSinus3Damping = uicontrol('Parent',hSourceOfSound3,...
                                        'Style','Slider',...
                                        'Position',[10 5 170 20],...
                                        'Enable','off');
                                    
            hMediumText = uicontrol('Parent',hfig,...
                                'Style','Text',...
                                'Position',[345 50 100 25],...
                                'String','Medium:',...
                                'FontSize',13);
                            
            hMedium = uicontrol('Parent',hfig,...
                                'Style','Popupmenu',...
                                'Position',[440 52.5 100 25],...
                                'String',{'Luft','Wasser','Stahl'},...
                                'FontSize',13);
                            
            hImage = image('Parent',hAnimationAxes,...
                           'CData',obj.Speaker1.Function,...
                           'CDataMapping','scaled');
                        
            obj.Handles = struct('hfig',hfig,...
                                 'hStart',hStart,...
                                 'hStop',hStop,...
                                 'hAnimation',hAnimation,...
                                 'hAnimationAxes',hAnimationAxes,...
                                 'hSourceOfSound1Tick',hSourceOfSound1Tick,...
                                 'hSourceOfSound1',hSourceOfSound1,...
                                 'hSourceOfSound2Tick',hSourceOfSound2Tick,...
                                 'hSourceOfSound2',hSourceOfSound2,...
                                 'hSourceOfSound3Tick',hSourceOfSound3Tick,...
                                 'hSourceOfSound3',hSourceOfSound3,...
                                 'hMedium',hMedium,...
                                 'hMediumText',hMediumText,...
                                 'hImage',hImage,...
                                 'hSinus1FrequenzText',hSinus1FrequenzText,...
                                 'hSinus1Frequenz',hSinus1Frequenz,...
                                 'hSinus1AmplitudeText',hSinus1AmplitudeText,...
                                 'hSinus1Amplitude',hSinus1Amplitude,...
                                 'hSinus1PhaseText',hSinus1PhaseText,...
                                 'hSinus1Phase',hSinus1Phase,...
                                 'hSinus1DampingText',hSinus1DampingText,...
                                 'hSinus1Damping',hSinus1Damping,...
                                 'hSinus2FrequenzText',hSinus2FrequenzText,...
                                 'hSinus2Frequenz',hSinus2Frequenz,...
                                 'hSinus2AmplitudeText',hSinus2AmplitudeText,...
                                 'hSinus2Amplitude',hSinus2Amplitude,...
                                 'hSinus2PhaseText',hSinus2PhaseText,...
                                 'hSinus2Phase',hSinus2Phase,...
                                 'hSinus2DampingText',hSinus2DampingText,...
                                 'hSinus2Damping',hSinus2Damping,...
                                 'hSinus3FrequenzText',hSinus3FrequenzText,...
                                 'hSinus3Frequenz',hSinus3Frequenz,...
                                 'hSinus3AmplitudeText',hSinus3AmplitudeText,...
                                 'hSinus3Amplitude',hSinus3Amplitude,...
                                 'hSinus3PhaseText',hSinus3PhaseText,...
                                 'hSinus3Phase',hSinus3Phase,...
                                 'hSinus3DampingText',hSinus3DampingText,...
                                 'hSinus3Damping',hSinus3Damping);
        end
        
        
        function closeGUI(obj)
            obj.stopAnimation;
            delete(obj.Timer);
            closereq;
        end
        
        
        function startAnimation(obj)
            if strcmp(obj.Timer.Running,'off')
            start(obj.Timer);
            end
        end
        
        
        function stopAnimation(obj)
            stop(obj.Timer);
        end
        
        
        function runAnimation(obj)
            set(obj.Handles.hImage,'CData',obj.Speaker1.getColorMap(obj.Timer.TasksExecuted));
            %image('parent',obj.Handles.hAnimationAxes,'CData',obj.S1.Function,'CDataMapping','scaled');
        end
        
        function setSourceOfSound1Tick(obj)
            if(obj.Handles.hSourceOfSound1Tick.Value == 1)
                obj.Handles.hSinus1Frequenz.Enable = 'on';
                obj.Handles.hSinus1Amplitude.Enable = 'on';
                obj.Handles.hSinus1Phase.Enable = 'on';
                obj.Handles.hSinus1Damping.Enable = 'on';
            else
                obj.Handles.hSinus1Frequenz.Enable = 'off';
                obj.Handles.hSinus1Amplitude.Enable = 'off';
                obj.Handles.hSinus1Phase.Enable = 'off';
                obj.Handles.hSinus1Damping.Enable = 'off';  
            end
        end
        
        function setSourceOfSound2Tick(obj)
            if(obj.Handles.hSourceOfSound2Tick.Value == 1)
                obj.Handles.hSinus2Frequenz.Enable = 'on';
                obj.Handles.hSinus2Amplitude.Enable = 'on';
                obj.Handles.hSinus2Phase.Enable = 'on';
                obj.Handles.hSinus2Damping.Enable = 'on';
            else
                obj.Handles.hSinus2Frequenz.Enable = 'off';
                obj.Handles.hSinus2Amplitude.Enable = 'off';
                obj.Handles.hSinus2Phase.Enable = 'off';
                obj.Handles.hSinus2Damping.Enable = 'off';  
            end
        end
        
        function setSourceOfSound3Tick(obj)
            if(obj.Handles.hSourceOfSound3Tick.Value == 1)
                obj.Handles.hSinus3Frequenz.Enable = 'on';
                obj.Handles.hSinus3Amplitude.Enable = 'on';
                obj.Handles.hSinus3Phase.Enable = 'on';
                obj.Handles.hSinus3Damping.Enable = 'on';
            else
                obj.Handles.hSinus3Frequenz.Enable = 'off';
                obj.Handles.hSinus3Amplitude.Enable = 'off';
                obj.Handles.hSinus3Phase.Enable = 'off';
                obj.Handles.hSinus3Damping.Enable = 'off';  
            end
        end
        
        function setSourceOfSound(obj,handle,event)
            hold on
            XCoordinate = event.IntersectionPoint(1);
            YCoordinate = event.IntersectionPoint(2);
            plot(XCoordinate,YCoordinate,'o')
            hold off
        end
    end
    
end

